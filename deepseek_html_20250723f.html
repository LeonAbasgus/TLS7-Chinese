<!DOCTYPE html>
<html lang="zh">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Ğ›ÑƒĞ½ÑŒ Ğ®Ğ¹ | è®ºè¯­ | Confucian Analects</title>
  <meta name="description" content="å¤šè¯­è¨€ç‰ˆã€Šè®ºè¯­ã€‹äº¤äº’å¼å­¦ä¹ å·¥å…·">
  <link rel="icon" href="favicon.ico" type="image/x-icon" />

  <!-- Ğ¨Ñ€Ğ¸Ñ„Ñ‚Ñ‹ -->
  <link href="https://fonts.googleapis.com/css2?family=Noto+Sans+SC:wght@400;700&family=Assistant&display=swap" rel="stylesheet" />

  <style>
    body {
      font-family: 'Assistant', sans-serif;
      background: #fdfdfb;
      color: #222;
      line-height: 1.6;
      margin: 1em;
      padding-top: 15px;
    }

    h1 {
      text-align: center;
      margin-bottom: 0.5em;
      color: #333;
    }

    .chinese {
      font-family: 'Noto Sans SC', sans-serif;
      font-size: 1.8em;
      margin-bottom: 0.3em;
      line-height: 1.8;
      text-align: center;
    }

    .pinyin {
      font-style: italic;
      margin-bottom: 0.4em;
      color: #4d77aa;
      text-align: center;
    }

    .translation {
      margin-bottom: 0.4em;
      text-align: center;
    }

    /* Ğ¡Ğ¸ÑÑ‚ĞµĞ¼Ğ° Ğ¿ĞµÑ€ĞµĞ²Ğ¾Ğ´Ğ° */
    .translation-ru { display: block; }
    .translation-en { display: none; }
    .translation-zh { display: none; }

    body.lang-en .translation-ru { display: none; }
    body.lang-en .translation-en { display: block; }
    body.lang-en .translation-zh { display: none; }

    body.lang-zh .translation-ru { display: none; }
    body.lang-zh .translation-en { display: none; }
    body.lang-zh .translation-zh { display: block; }

    .verse {
      padding: 1.2em 0;
      border-bottom: 1px solid #eee;
      max-width: 800px;
      margin: 0 auto;
    }

    .word {
      position: relative;
      cursor: help;
      white-space: nowrap;
    }

    .syntax {
      background: #eef3ff;
      padding: 0.6em 1em;
      border-left: 4px solid #4d77aa;
      margin: 0.8em auto 0;
      font-size: 0.95em;
      max-width: 600px;
      border-radius: 0 4px 4px 0;
    }

    #interface-bar {
      position: sticky;
      top: 0;
      background: rgba(253, 253, 251, 0.9);
      backdrop-filter: blur(5px);
      z-index: 999;
      display: flex;
      justify-content: center;
      flex-wrap: wrap;
      gap: 1.5em;
      padding: 0.8em 1em;
      border-bottom: 1px solid #ddd;
      font-size: 0.95em;
      margin-bottom: 1em;
    }

    #info-bar {
      display: none;
      position: fixed;
      bottom: 0;
      left: 0;
      width: 100%;
      background: rgba(244, 244, 244, 0.95);
      color: #000;
      padding: 0.6em 1em;
      border-top: 1px solid #ccc;
      font-size: 0.9em;
      z-index: 1000;
      text-align: center;
    }

    @media (max-width: 600px) {
      body {
        margin: 0.5em;
        padding-top: 70px;
      }
      #interface-bar {
        gap: 0.8em;
        padding: 0.6em;
      }
      .chinese {
        font-size: 1.5em;
      }
    }
  </style>
</head>
<body class="lang-ru">
  <h1>è®ºè¯­ | Ğ›ÑƒĞ½ÑŒ Ğ®Ğ¹ | Analects</h1>

  <div id="interface-bar">
    <label style="white-space: nowrap;">
      <input type="checkbox" id="toggle-list-mode" />
      ğŸ“– <span id="morph-label">ĞœĞ¾Ñ€Ñ„Ğ¾Ğ»Ğ¾Ğ³Ğ¸Ñ</span>
    </label>
    
    <label for="translation-select" style="white-space: nowrap;">
      ğŸŒ <span id="lang-label">Ğ¯Ğ·Ñ‹Ğº:</span>
      <select id="translation-select">
        <option value="ru" selected>Ğ ÑƒÑÑĞºĞ¸Ğ¹</option>
        <option value="en">English</option>
        <option value="zh">ä¸­æ–‡</option>
      </select>
    </label>
  </div>

  <div id="content">
    <!-- Ğ¦Ğ¸Ñ‚Ğ°Ñ‚Ğ° 1 -->
    <div class="verse" data-audio="audio/verse1.mp3">
      <p class="chinese">
        <span class="word" data-info-ru="å­¦ (xuÃ©): ÑƒÑ‡Ğ¸Ñ‚ÑŒÑÑ" data-info-en="å­¦ (xuÃ©): to learn" data-info-zh="å­¦ (xuÃ©): å­¦ä¹ ">å­¦</span>
        <span class="word" data-info-ru="è€Œ (Ã©r): Ğ¸" data-info-en="è€Œ (Ã©r): and" data-info-zh="è€Œ (Ã©r): å’Œ">è€Œ</span>
        <span class="word" data-info-ru="æ—¶ (shÃ­): Ğ¿Ğ¾ÑÑ‚Ğ¾ÑĞ½Ğ½Ğ¾" data-info-en="æ—¶ (shÃ­): constantly" data-info-zh="æ—¶ (shÃ­): ç»å¸¸">æ—¶</span>
        <span class="word" data-info-ru="ä¹  (xÃ­): Ğ¿Ğ¾Ğ²Ñ‚Ğ¾Ñ€ÑÑ‚ÑŒ" data-info-en="ä¹  (xÃ­): to practice" data-info-zh="ä¹  (xÃ­): ç»ƒä¹ ">ä¹ </span>
        <span class="word" data-info-ru="ä¹‹ (zhÄ«): ÑÑ‚Ğ¾" data-info-en="ä¹‹ (zhÄ«): it" data-info-zh="ä¹‹ (zhÄ«): å®ƒ">ä¹‹</span>ï¼Œ
        <span class="word" data-info-ru="ä¸ (bÃ¹): Ğ½Ğµ" data-info-en="ä¸ (bÃ¹): not" data-info-zh="ä¸ (bÃ¹): ä¸">ä¸</span>
        <span class="word" data-info-ru="äº¦ (yÃ¬): Ñ€Ğ°Ğ·Ğ²Ğµ" data-info-en="äº¦ (yÃ¬): indeed" data-info-zh="äº¦ (yÃ¬): ä¹Ÿ">äº¦</span>
        <span class="word" data-info-ru="è¯´ (yuÃ¨): Ñ€Ğ°Ğ´Ğ¾ÑÑ‚ÑŒ" data-info-en="è¯´ (yuÃ¨): joy" data-info-zh="è¯´ (yuÃ¨): å¿«ä¹">è¯´</span>
        <span class="word" data-info-ru="ä¹ (hÅ«): (Ğ²Ğ¾Ğ¿Ñ€Ğ¾Ñ)" data-info-en="ä¹ (hÅ«): (question)" data-info-zh="ä¹ (hÅ«): ï¼ˆç–‘é—®ï¼‰">ä¹</span>ï¼Ÿ
      </p>
      <p class="pinyin">
        XuÃ© Ã©r shÃ­ xÃ­ zhÄ«, bÃ¹ yÃ¬ yuÃ¨ hÅ«?
      </p>
      <p class="translation translation-ru">
        "Ğ£Ñ‡Ğ¸Ñ‚ÑŒÑÑ Ğ¸ Ğ¿Ğ¾ÑÑ‚Ğ¾ÑĞ½Ğ½Ğ¾ Ğ¿Ğ¾Ğ²Ñ‚Ğ¾Ñ€ÑÑ‚ÑŒ â€” Ñ€Ğ°Ğ·Ğ²Ğµ ÑÑ‚Ğ¾ Ğ½Ğµ Ñ€Ğ°Ğ´Ğ¾ÑÑ‚ÑŒ?"
      </p>
      <p class="translation translation-en">
        "Is it not a joy to learn and practice constantly?"
      </p>
      <p class="translation translation-zh">
        â€œå­¦è€Œæ—¶ä¹ ä¹‹ï¼Œä¸äº¦è¯´ä¹ï¼Ÿâ€ï¼ˆä¸æ–­å­¦ä¹ å¹¶å®è·µï¼Œä¸æ˜¯å¾ˆæ„‰å¿«å—ï¼Ÿï¼‰
      </p>
      <div class="syntax">
        ğŸ§  <strong class="syntax-title">Ğ¡Ğ¸Ğ½Ñ‚Ğ°ĞºÑĞ¸Ñ:</strong>
        <span class="syntax-ru">Ğ Ğ¸Ñ‚Ğ¾Ñ€Ğ¸Ñ‡ĞµÑĞºĞ¸Ğ¹ Ğ²Ğ¾Ğ¿Ñ€Ğ¾Ñ Ñ Ğ³Ğ»Ğ°Ğ³Ğ¾Ğ»ÑŒĞ½Ğ¾Ğ¹ Ñ†ĞµĞ¿Ğ¾Ñ‡ĞºĞ¾Ğ¹</span>
        <span class="syntax-en">Rhetorical question with verb chain</span>
        <span class="syntax-zh">åé—®å¥å¼ä¸åŠ¨è¯è¿ç”¨</span>
      </div>
    </div>

    <!-- Ğ¦Ğ¸Ñ‚Ğ°Ñ‚Ğ° 2 -->
    <div class="verse" data-audio="audio/verse2.mp3">
      <p class="chinese">
        <span class="word" data-info-ru="æœ‰ (yÇ’u): Ğ¸Ğ¼ĞµÑ‚ÑŒ" data-info-en="æœ‰ (yÇ’u): to have" data-info-zh="æœ‰ (yÇ’u): æœ‰">æœ‰</span>
        <span class="word" data-info-ru="æœ‹ (pÃ©ng): Ğ´Ñ€ÑƒĞ³" data-info-en="æœ‹ (pÃ©ng): friend" data-info-zh="æœ‹ (pÃ©ng): æœ‹å‹">æœ‹</span>
        <span class="word" data-info-ru="è‡ª (zÃ¬): Ğ¸Ğ·" data-info-en="è‡ª (zÃ¬): from" data-info-zh="è‡ª (zÃ¬): ä»">è‡ª</span>
        <span class="word" data-info-ru="è¿œæ–¹ (yuÇnfÄng): Ğ´Ğ°Ğ»ĞµĞºĞ¾" data-info-en="è¿œæ–¹ (yuÇnfÄng): afar" data-info-zh="è¿œæ–¹ (yuÇnfÄng): è¿œæ–¹">è¿œæ–¹</span>
        <span class="word" data-info-ru="æ¥ (lÃ¡i): Ğ¿Ñ€Ğ¸Ñ…Ğ¾Ğ´Ğ¸Ñ‚ÑŒ" data-info-en="æ¥ (lÃ¡i): to come" data-info-zh="æ¥ (lÃ¡i): æ¥">æ¥</span>ï¼Œ
        <span class="word" data-info-ru="ä¸ (bÃ¹): Ğ½Ğµ" data-info-en="ä¸ (bÃ¹): not" data-info-zh="ä¸ (bÃ¹): ä¸">ä¸</span>
        <span class="word" data-info-ru="äº¦ (yÃ¬): Ñ€Ğ°Ğ·Ğ²Ğµ" data-info-en="äº¦ (yÃ¬): indeed" data-info-zh="äº¦ (yÃ¬): ä¹Ÿ">äº¦</span>
        <span class="word" data-info-ru="ä¹ (lÃ¨): ÑƒĞ´Ğ¾Ğ²Ğ¾Ğ»ÑŒÑÑ‚Ğ²Ğ¸Ğµ" data-info-en="ä¹ (lÃ¨): pleasure" data-info-zh="ä¹ (lÃ¨): å¿«ä¹">ä¹</span>
        <span class="word" data-info-ru="ä¹ (hÅ«): (Ğ²Ğ¾Ğ¿Ñ€Ğ¾Ñ)" data-info-en="ä¹ (hÅ«): (question)" data-info-zh="ä¹ (hÅ«): ï¼ˆç–‘é—®ï¼‰">ä¹</span>ï¼Ÿ
      </p>
      <p class="pinyin">
        YÇ’u pÃ©ng zÃ¬ yuÇnfÄng lÃ¡i, bÃ¹ yÃ¬ lÃ¨ hÅ«?
      </p>
      <p class="translation translation-ru">
        "ĞšĞ¾Ğ³Ğ´Ğ° Ğ´Ñ€ÑƒĞ·ÑŒÑ Ğ¿Ñ€Ğ¸Ñ…Ğ¾Ğ´ÑÑ‚ Ğ¸Ğ·Ğ´Ğ°Ğ»ĞµĞºĞ° â€” Ñ€Ğ°Ğ·Ğ²Ğµ ÑÑ‚Ğ¾ Ğ½Ğµ ÑƒĞ´Ğ¾Ğ²Ğ¾Ğ»ÑŒÑÑ‚Ğ²Ğ¸Ğµ?"
      </p>
      <p class="translation translation-en">
        "When friends come from afar â€” is this not delightful?"
      </p>
      <p class="translation translation-zh">
        â€œæœ‰æœ‹è‡ªè¿œæ–¹æ¥ï¼Œä¸äº¦ä¹ä¹ï¼Ÿâ€ï¼ˆæœ‰æœ‹å‹ä»è¿œæ–¹æ¥ï¼Œä¸æ˜¯å¾ˆé«˜å…´å—ï¼Ÿï¼‰
      </p>
      <div class="syntax">
        ğŸ§  <strong class="syntax-title">Ğ¡Ğ¸Ğ½Ñ‚Ğ°ĞºÑĞ¸Ñ:</strong>
        <span class="syntax-ru">Ğ’Ñ€ĞµĞ¼ĞµĞ½Ğ½Ğ°Ñ ĞºĞ¾Ğ½ÑÑ‚Ñ€ÑƒĞºÑ†Ğ¸Ñ Ñ Ñ€Ğ¸Ñ‚Ğ¾Ñ€Ğ¸Ñ‡ĞµÑĞºĞ¸Ğ¼ Ğ²Ğ¾Ğ¿Ñ€Ğ¾ÑĞ¾Ğ¼</span>
        <span class="syntax-en">Temporal construction with rhetorical question</span>
        <span class="syntax-zh">æ—¶é—´ç»“æ„ä¸åé—®å¥</span>
      </div>
    </div>
  </div>

  <div id="info-bar"></div>

  <script>
    document.addEventListener('DOMContentLoaded', function() {
      // Ğ­Ğ»ĞµĞ¼ĞµĞ½Ñ‚Ñ‹ ÑƒĞ¿Ñ€Ğ°Ğ²Ğ»ĞµĞ½Ğ¸Ñ
      const listModeToggle = document.getElementById('toggle-list-mode');
      const translationSelect = document.getElementById('translation-select');
      const infoBar = document.getElementById('info-bar');
      
      // Ğ›Ğ¾ĞºĞ°Ğ»Ğ¸Ğ·Ğ°Ñ†Ğ¸Ñ Ğ¸Ğ½Ñ‚ĞµÑ€Ñ„ĞµĞ¹ÑĞ°
      const labels = {
        ru: { morph: 'ĞœĞ¾Ñ€Ñ„Ğ¾Ğ»Ğ¾Ğ³Ğ¸Ñ', lang: 'Ğ¯Ğ·Ñ‹Ğº:' },
        en: { morph: 'Morphology', lang: 'Language:' },
        zh: { morph: 'è¯æ³•', lang: 'è¯­è¨€:' }
      };

      // Ğ’Ğ¾ÑÑÑ‚Ğ°Ğ½Ğ¾Ğ²Ğ»ĞµĞ½Ğ¸Ğµ Ğ½Ğ°ÑÑ‚Ñ€Ğ¾ĞµĞº
      if (localStorage.getItem('morphMode') === 'list') {
        listModeToggle.checked = true;
      }
      const savedLang = localStorage.getItem('translationLang') || 'ru';
      translationSelect.value = savedLang;
      updateLanguage(savedLang);

      // ĞĞ±Ñ€Ğ°Ğ±Ğ¾Ñ‚Ñ‡Ğ¸ĞºĞ¸ ÑĞ¾Ğ±Ñ‹Ñ‚Ğ¸Ğ¹
      listModeToggle.addEventListener('change', toggleMorphologyMode);
      translationSelect.addEventListener('change', changeLanguage);
      
      // Ğ˜Ğ½Ğ¸Ñ†Ğ¸Ğ°Ğ»Ğ¸Ğ·Ğ°Ñ†Ğ¸Ñ
      updateMorphologyDisplay();
      setupWordTooltips();
      setupAudio();

      // Ğ¤ÑƒĞ½ĞºÑ†Ğ¸Ğ¸
      function toggleMorphologyMode() {
        localStorage.setItem('morphMode', listModeToggle.checked ? 'list' : 'tooltip');
        updateMorphologyDisplay();
      }

      function changeLanguage() {
        const lang = translationSelect.value;
        localStorage.setItem('translationLang', lang);
        updateLanguage(lang);
        updateMorphologyDisplay();
      }

      function updateLanguage(lang) {
        document.body.className = `lang-${lang}`;
        document.getElementById('morph-label').textContent = labels[lang].morph;
        document.getElementById('lang-label').textContent = labels[lang].lang;
        
        // ĞĞ±Ğ½Ğ¾Ğ²Ğ»ÑĞµĞ¼ ÑĞ¸Ğ½Ñ‚Ğ°ĞºÑĞ¸Ñ
        document.querySelectorAll('.syntax-title').forEach(el => {
          el.textContent = lang === 'ru' ? 'Ğ¡Ğ¸Ğ½Ñ‚Ğ°ĞºÑĞ¸Ñ:' : 
                          lang === 'en' ? 'Syntax:' : 'è¯­æ³•:';
        });
      }

      function updateMorphologyDisplay() {
        const isListMode = listModeToggle.checked;
        const currentLang = translationSelect.value;
        
        document.querySelectorAll('.verse').forEach(verse => {
          // Ğ£Ğ´Ğ°Ğ»ÑĞµĞ¼ ÑÑ‚Ğ°Ñ€Ñ‹Ğ¹ ÑĞ¿Ğ¸ÑĞ¾Ğº
          const oldList = verse.querySelector('.morph-list');
          if (oldList) oldList.remove();

          // Ğ¡Ğ¾Ğ·Ğ´Ğ°Ñ‘Ğ¼ Ğ½Ğ¾Ğ²Ñ‹Ğ¹ ÑĞ¿Ğ¸ÑĞ¾Ğº Ğ² Ñ€ĞµĞ¶Ğ¸Ğ¼Ğµ ÑĞ¿Ğ¸ÑĞºĞ°
          if (isListMode) {
            const words = verse.querySelectorAll('.word');
            let listHTML = '<ul class="morph-list" style="margin:0.5em auto 0;padding-left:1.5em;max-width:600px;font-size:0.9em;">';
            
            words.forEach(word => {
              const info = word.getAttribute(`data-info-${currentLang}`) || '';
              listHTML += `<li>${word.textContent}: ${info}</li>`;
            });
            
            listHTML += '</ul>';
            verse.insertAdjacentHTML('beforeend', listHTML);
          }
        });
      }

      function setupWordTooltips() {
        document.querySelectorAll('.word').forEach(word => {
          word.onclick = (e) => {
            if (!listModeToggle.checked) {
              e.preventDefault();
              const currentLang = translationSelect.value;
              const info = word.getAttribute(`data-info-${currentLang}`) || '';
              
              infoBar.textContent = info;
              infoBar.style.display = 'block';
              
              clearTimeout(infoBar._hideTimer);
              infoBar._hideTimer = setTimeout(() => {
                infoBar.style.display = 'none';
              }, 3000);
            }
          };
        });
      }

      function setupAudio() {
        document.querySelectorAll('.verse').forEach(verse => {
          verse.addEventListener('click', (e) => {
            if (!e.target.classList.contains('word')) {
              const audioSrc = verse.getAttribute('data-audio');
              if (audioSrc) new Audio(audioSrc).play();
            }
          });
        });
      }
    });
  </script>
</body>
</html>